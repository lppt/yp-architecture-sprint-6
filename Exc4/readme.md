# Задание 4. Проектирование продажи ОСАГО

## Требуется ли ему своё хранилище данных?

Я бы конечно вместо хранилища предложил использовать artemismq, если позволяют компетенции команды.
Организуем топик, к нему вяжем перманентные очереди на обработку заявок и акноледжим их только после обработки, а сами результаты можно отправлять и в кафку. Но это только в случае если мы считаем что при падении сервиса osago-aggregator потери пользовательских заявок будут приносить бизнесу большие потери.
А так не вижу необходимости в хранилище

## Какой API он предоставляет core-app?

Он позволяет создать заявку на ОСАГО и получить результат по заявке для каждой из страховых компаний.

## Определите средство интеграции между сервисами core-app и osago-aggregator.

Если потеря некоторых заявок критична, то artemis / kafka+storage, если нет, то только kafka

## Подумайте над API для веб-приложения в core-app.

Тут я думаю достаточно будет пулинга раз в 5-10 секунд.
Т.е. 2 метода
POST /osago/calculate
Принимает параметры заявки, возвращает идентификатор запроса
GET /osago/calculation-results
Выдает результаты по идентификатору заявки

## Определите средство интеграции между веб-приложением и core-app. Если будете использовать средство, отличное от REST, отразите интеграцию новой стрелкой.

Собственно достаточно пулинга

## В зависимости от выбранных средств интеграции подумайте, требуется ли где-то применение паттернов отказоустойчивости:

1. Ограничиваем количество запросов на core-app Rate Limiting

2. При обрыве соединения со страховыми - делаем перезапросы - Retry на osago-aggregator

3. Если сервис страховой не отвечает в течении 60 секунд, то считаем что они не успели - Timeout
